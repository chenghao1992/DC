"use strict";app.controller("QuestionsOfDiseaseCtrl",function($rootScope,$scope,$state,$http,$compile,utils,$modal,toaster){function setTable(info){function dataTable(data){datable&&datable.fnClearTable(),datable=$("#planListDatable").dataTable({language:app.lang.datatables.translation,ordering:!1,searching:!1,bDestroy:!0,lengthMenu:[10,15,20,30,40,50,100],data:data,columns:[{data:"ghnrContent",defaultContent:""},{data:null,defaultContent:"<button class='btn btn-xs btn-primary text-xs'>详情</button>"}],createdRow:function(nRow,aData,iDataIndex){$(nRow).on("click","button",function(){getView(aData)})}})}$scope.diseaseNameSelected=info.name,$http.post(app.yiliao+"pack/care/queryCareTemplateItem",{access_token:app.url.access_token,categoryId:info.id,type:1}).then(function(rpn){console.log(rpn.data),1===rpn.data.resultCode?dataTable(rpn.data.data):toaster.pop("error",null,"获取失败")})}function getView(data){var viewData={};$http.post(app.yiliao+"pack/care/findCareTemplateById",{access_token:app.url.access_token,careId:data.ghnrId,type:1}).then(function(rpn){if(console.log(rpn.data),1===rpn.data.resultCode){viewData={ghnrId:data.ghnrId,ghnrContent:data.ghnrContent,answerTemplates:rpn.data.data.answerTemplates};$modal.open({animation:!0,templateUrl:"myModalContent.html",controller:"viewPopCtrl2",size:["100","30"],resolve:{viewData:function(){return viewData}}})}else toaster.pop("error",null,"获取失败")})}var contacts=new Tree("sch_cnt_list",{hasCheck:!1,allCheck:!1,multiple:!1,allHaveArr:!1,self:!0,search:!1,arrType:[1,0],data:{url:app.yiliao+"group/stat/getDiseaseTypeTree",param:{access_token:app.url.access_token,groupId:localStorage.getItem("curGroupId"),tmpType:3}},datakey:{id:"id",name:"name",sub:"children"},info:{name:"name",id:"id",pid:"department",leaf:"leaf"},root:{selectable:!0,name:"全部",id:null},events:{click:setTable},callback:function(){var dts=contacts.tree.find("dt");setTable(dts.eq(0).data().info)}}),datable=null;setTable({})}),app.controller("viewPopCtrl2",function($rootScope,$scope,$modalInstance,$http,utils,viewData){$scope.viewData=viewData,$scope.cancel=function(){$modalInstance.dismiss("cancel")}});