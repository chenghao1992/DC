"use strict";app.controller("ChargeListCtrl",function($scope,$state,$http,toaster,$modal){var groupId=app.url.groupId();$scope.options={type:[{value:1,title:"咨询套餐"},{value:2,title:"报到套餐"},{value:3,title:"门诊套餐"},{value:4,title:"健康关怀套餐"},{value:5,title:"随访套餐"},{value:6,title:"直通车套餐"},{value:7,title:"会诊套餐"},{value:9,title:"预约套餐"},{value:10,title:"收费单"}],Booktype:[{value:9,title:"预约套餐"},{value:10,title:"收费单"}],status:[{value:1,title:"待预约"},{value:2,title:"待支付"},{value:3,title:"已支付"},{value:4,title:"已完成"},{value:5,title:"已取消"},{value:6,title:"进行中"},{value:7,title:"待完善"},{value:10,title:"预约成功"}]},$scope.funGetTitleByValue=function(value,arry){for(var i=0;i<arry.length;i++)if(value==arry[i].value)return arry[i].title;return value},$scope.funTimeToLong=function(time,type){if(type&&time[type]){var _long=new Date(time[type]).getTime();return"endCreateTime"==type&&(_long=_long-0+86399e3),time[type]=_long,_long}},$scope.page={},$scope.search={},$scope.funGetOrderList=function _funGetOrderList(page,search){$scope.page.index=page.index||1,$scope.page.size=page.size||30,void 0==search&&(search={}),$scope.search={orderStatus:search.orderStatus||"",doctorName:search.doctorName||"",orderType:search.orderType||"",patientName:search.patientName||"",hostpitalName:search.hostpitalName||"",startCreateTime:search.startCreateTime||"",endCreateTime:search.endCreateTime||""},$scope.downLoadUrl=app.url.order.downOrderList+"?access_token="+app.url.access_token+"&groupId="+groupId+"&orderStatus="+$scope.search.orderStatus+"&orderType="+$scope.search.orderType+"&doctorName="+$scope.search.doctorName+"&patientName="+$scope.search.patientName+"&hostpitalName="+$scope.search.hostpitalName+"&startCreateTime="+$scope.search.startCreateTime+"&endCreateTime="+$scope.search.endCreateTime;var params={access_token:app.url.access_token,groupId:groupId,pageIndex:$scope.page.index-1,pageSize:$scope.page.size,orderStatus:$scope.search.orderStatus||"",doctorName:$scope.search.doctorName||"",patientName:$scope.search.patientName||"",hostpitalName:$scope.search.hostpitalName||"",startCreateTime:$scope.search.startCreateTime||"",endCreateTime:$scope.search.endCreateTime||""};return"1"==$scope.orderType||"2"==$scope.orderType?params.packType=$scope.orderType:params.orderType=$scope.orderType,$http.post(app.url.order.getOrderList,params).then(function(rpn){rpn=rpn.data,1===rpn.resultCode?($scope.page.count=rpn.data.total,$scope.planList=rpn.data.pageData):rpn.resultMsg?toaster.pop("error",null,rpn.resultMsg):toaster.pop("error",null,"接口出错")}),_funGetOrderList}($scope.page,$scope.search),$scope.page.changed=function(){$scope.funGetOrderList($scope.page,$scope.search)},$scope.open=function($event,typeBtn){$event.preventDefault(),$event.stopPropagation(),$scope[typeBtn]=!0}});