"use strict";app.controller("ContactsListApportion",function($rootScope,$scope,$state,$timeout,$http,utils){function check(info){var target=$(contacts.getTargets());if(0===target.length)return void list_wrapper.html("");list_arr=[];var span=$('<span class="label-btn btn-info"></span>'),i=$('<i class="fa fa-times"></i>');$scope.formData.id=info.id,list_arr.push(info.id),list_wrapper.html(""),list_wrapper.html(span.html(info.name).append(i)),i.click(function(){contacts.setCheck(info.id),list_wrapper.html(""),$scope.formData.id=null,list_arr=[]})}var url=app.url.yiliao.getAllData,container=$("#dialog_container"),html=($("#cnt_list_apportion"),$("html")),list_wrapper=$("#cnt_list_wrapper"),list_arr=[],groupId=utils.localData("curGroupId");$scope.viewData={},$scope.formData={},$scope.viewData.headPicFile=$scope.doctorInfo.headPicFile,$scope.viewData.name=$scope.doctorInfo.name,html.css("overflow","hidden"),list_wrapper.html("");var contacts=new Tree("cnt_list_apportion",{hasCheck:!1,allCheck:!1,multiple:!1,allHaveArr:!1,self:!0,search:!1,arrType:[1,1,1,0],data:{url:url,param:{access_token:app.url.access_token,groupId:groupId}},async:!1,icons:{arrow:"fa fa-caret-right/fa fa-caret-down",check:"fa fa-check/fa fa-square",root:"fa fa-hospital-o dcolor",branch:"fa fa-h-square dcolor",leaf:"fa fa-user-md dcolor"},datakey:{id:"id",name:"name",sub:"subList"},info:{name:"name",id:"id",pid:"parentId",description:"description"},events:{click:check},callback:function(){$("#cnt_list_apportion")}});$scope.save=function(){$http({url:app.url.yiliao.saveDoctor,method:"post",data:{access_token:app.url.access_token,departmentIds:list_arr,doctorId:$scope.doctorInfo.id,groupId:groupId}}).then(function(resp){1===resp.data.resultCode?(console.log("分配成功！"),$state.go("app.contacts.list",{id:$scope.curDepartmentId},{reload:!0}),html.css("overflow","auto")):console.warn("分配失败！")},function(x){console.error(x.statusText)})},$scope.cancel=function(){container.prev().remove(),container.remove(),$state.go("app.contacts.list",{id:$scope.curDepartmentId},{reload:!1}),html.css("overflow","auto")}});