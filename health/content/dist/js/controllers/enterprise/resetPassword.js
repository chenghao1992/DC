"use strict";app.controller("forgotpwdCtrl",["$rootScope","$scope","$http","$state","$cookieStore","utils",function($rootScope,$scope,$http,$state,$cookieStore,utils){$scope.phone=$rootScope.phone||"",$scope.getSmsBT="获取验证码",$scope.preResetPassword=function(){$scope.getSmsBTState=!0,$http.post(app.url.preResetPassword,{phone:$scope.phone,userType:5}).success(function(data){if(1===data.resultCode){$scope.smsid=data.data.smsid,$scope.resetPwdState=!0,$scope.phoneState=!0,console.log(data.data.smsid),$scope.getSmsBT=160;var getSms=setInterval(function(){$scope.$apply(function(){$scope.getSmsBT--,0==$scope.getSmsBT&&($scope.getSmsBT="获取验证码",$scope.getSmsBTState=!1,clearInterval(getSms))})},1e3)}else $scope.getSmsBTState=!1,$scope.authError=data.resultMsg}).error(function(data){$scope.getSmsBTState=!1,$scope.authError="服务器错误！"})},$scope.resetPassword=function(){$http.post(app.url.resetPassword,{phone:$scope.phone,userType:5,smsid:$scope.smsid,ranCode:$scope.code,password:$scope.pwd}).success(function(data){return console.log(data),1===data.resultCode?($scope.success="立即登录",$scope.authError="修改成功！"):void($scope.authError=data.resultMsg)}).error(function(data){$scope.authError=data.resultMsg})}}]);