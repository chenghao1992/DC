"use strict";app.controller("appointmentEdit",["$rootScope","$scope","$modal","$log","$http","$state","$stateParams","utils","modal","Group","toaster","AppFactory",function($rootScope,$scope,$modal,$log,$http,$state,$stateParams,utils,modal,Group,toaster,AppFactory){function funCheckParam(_data){return!_data.openAppointment||(_data.appointmentMin<=0?(toaster.pop("error",null,"集团预约收费价格不能少于0"),!1):100<_data.appointmentGroupProfit||_data.appointmentGroupProfit<0?(toaster.pop("error",null,"集团分成比例范围为0%～100%"),!1):100<_data.appointmentParentProfit||_data.appointmentParentProfit<0?(toaster.pop("error",null,"上级分成比例范围为0%～100%"),!1):!(_data.appointmentGroupProfit-0+(_data.appointmentParentProfit-0)>100)||(toaster.pop("error",null,"集团抽成与上级抽成比例之和不能大于100%"),!1))}$scope.currentOrgInfo=Group.getCurrentOrgInfo(),$scope.appointment={openAppointment:!1,appointmentGroupProfit:0,appointmentParentProfit:0,appointmentMin:0},function(){$http.post(app.url.order.getAppointmentInfo,{access_token:localStorage.getItem("access_token"),groupId:$scope.currentOrgInfo.id}).then(function(_data){_data=AppFactory.ajax.dealHealth(_data),_data&&($scope.appointment={openAppointment:_data.openAppointment,appointmentGroupProfit:_data.appointmentGroupProfit,appointmentParentProfit:_data.appointmentParentProfit,appointmentMin:_data.appointmentMin/100})})}(),$scope.funSetAppointment=function(appointment){funCheckParam(appointment)&&$http.post(app.url.order.setAppointmentInfo,{access_token:localStorage.getItem("access_token"),groupId:$scope.currentOrgInfo.id,openAppointment:appointment.openAppointment,appointmentGroupProfit:appointment.appointmentGroupProfit,appointmentParentProfit:appointment.appointmentParentProfit,appointmentMin:100*appointment.appointmentMin}).then(function(_data){_data=AppFactory.ajax.dealHealth(_data),_data&&toaster.pop("success",null,"设置成功")})}}]);