"use strict";app.controller("groupDrugLibraryCtrl",function($rootScope,$scope,$http,toaster,$modal,SelectMedicineBoxFactory){$scope.url=app.url.drugLibrary.searchDoctorGroupDrugLibList,$scope.params={groupId:localStorage.getItem("curGroupId"),access_token:localStorage.getItem("access_token")},$scope.openDrugBox=function(){var medicineIds=[];SelectMedicineBoxFactory.open({medicines:[],access_token:app.url.access_token,callback:function(medicines){medicines.forEach(function(item){medicineIds.push(item.id)}),$http.post(app.url.drugLibrary.addDoctorGroupDrugLibGoods,{groupId:localStorage.getItem("curGroupId"),access_token:localStorage.getItem("access_token"),ids:medicineIds}).then(function(rpn){rpn.data&&1==rpn.data.resultCode?(toaster.pop("success",null,"添加成功"),$scope.params={groupId:localStorage.getItem("curGroupId"),access_token:localStorage.getItem("access_token")}):(toaster.pop("error",null,"添加失败"),console.warn(rpn))})}})},$scope.deletePlan=function(id){$http.post(app.url.drugLibrary.deleteDoctorGroupDrugById,{groupId:localStorage.getItem("curGroupId"),access_token:localStorage.getItem("access_token"),id:id}).then(function(rpn){rpn.data&&1==rpn.data.resultCode?(toaster.pop("success",null,"删除成功"),$scope.params={groupId:localStorage.getItem("curGroupId"),access_token:localStorage.getItem("access_token")}):(toaster.pop("error",null,"删除失败"),console.warn(rpn))})},$scope["delete"]=function(planId){var modalInstance=$modal.open({templateUrl:"delModalContent.html",controller:"delModalInstanceCtrl",size:"sm"});modalInstance.result.then(function(status){"ok"==status&&$scope.deletePlan(planId,-1)})}}),app.controller("delModalInstanceCtrl",function($scope,$modalInstance,toaster,$http,utils){$scope.ok=function(){$modalInstance.close("ok")},$scope.cancel=function(){$modalInstance.dismiss("cancel")}});