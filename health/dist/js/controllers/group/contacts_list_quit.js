"use strict";app.controller("ContactsListAdd",function($rootScope,$scope,$state,$timeout,$http,utils){var container=$("#dialog_container");$scope.viewData={},$scope.showInfo=!0,$scope.showWarn=!1;var doctorId=$scope.doctorInfo.id,html=$("html"),deptId=$scope.curDepartmentId||utils.localData("curDepartmentId"),groupId=$scope.curGroupId||utils.localData("curGroupId");if(doctorId&&deptId){$scope.viewData.headPicFile=$scope.doctorInfo.headPicFile,$scope.viewData.name=$scope.doctorInfo.name||"--";var ttl,dpt,hsp;$http({url:app.url.doctor.getWork,method:"post",data:{access_token:app.url.access_token,userId:doctorId}}).then(function(resp){if(1===resp.data.resultCode){var dt=resp.data.data;ttl=dt.title||"--",dpt=dt.departments||"--",hsp=dt.hospital||"--",$scope.viewData.info=ttl+" / "+dpt+" / "+hsp}},function(x){console.error(x.statusText)});var doIt=function(){$http({url:app.url.yiliao.dimission,method:"post",data:{access_token:app.url.access_token,groupId:groupId,doctorId:doctorId}}).then(function(resp){1===resp.data.resultCode?($state.go("app.contacts.list",{id:deptId},{reload:!0}),html.css("overflow","auto")):($scope.showInfo=!1,$scope.showWarn=!0,$scope.formData.warn_text=resp.data.resultMsg||"操作失败！",console.warn((resp.data.resultMsg||"操作失败！")+" (代码："+resp.data.resultCode+")"))},function(x){console.error(x.statusText)})};$scope["do"]=function(){doIt()},$scope.cancel=function(){container.prev().remove(),container.remove(),$state.go("app.contacts.list.details")}}});