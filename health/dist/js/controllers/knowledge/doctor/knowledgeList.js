"use strict";function deletedoctorKlgContentCtrl($scope,$modalInstance,data){$scope.doctor=data,console.log(data),$scope.ok=function(){$modalInstance.close(!0)},$scope.cancel=function(){$modalInstance.dismiss(!1)}}!function(){function funGroupKnowledgeListCtrl($scope,$http,$state,$modal,toaster,$stateParams,$rootScope,$timeout){var curGroupId=localStorage.getItem("curGroupId");$scope.hasGroupId=!!localStorage.getItem("curGroupId");var userId=localStorage.getItem("user_id");$scope.isPersonKnowledgeEdit="true"==$stateParams.isPersonKnowledge,$scope.isEditBeforeWidthcategoryId=$stateParams.isEditBeforeWidthcategoryId,$scope.isSearchByAllCategory="true"==$stateParams.isSearchByAllCategory,$scope.isEditBeforeWidthcategoryId?$scope.carActiveId=$scope.isEditBeforeWidthcategoryId:$scope.isPersonKnowledgeEdit?$scope.carActiveId="perCargId":$scope.carActiveId="allCarg",$scope.isPersonKnowledge=!1,$scope.isNum=1,$scope.pageSize=10,$scope.pageIndex=1,$scope.whichType=1,$scope.getCategoryList=function(){$http.post(app.url.knowledge.getCategoryList,{access_token:app.url.access_token,groupId:curGroupId}).success(function(data){1==data.resultCode&&($scope.categoryList=data.data)}).error(function(data){toaster.pop("error",null,"服务器通讯出错")})},$scope.hasGroupId&&$scope.getCategoryList(),$scope.addGroupCategory=function(item){var modalInstance=$modal.open({templateUrl:"addGroupCategory.html",controller:"addGroupCategoryCtrl",windowClass:"docPreModal",resolve:{item:function(){return item}}});modalInstance.result.then(function(){$scope.getCategoryList()},function(){})},$scope.deleteGroupCategory=function(item){var modalInstance=$modal.open({templateUrl:"deleteGroupCategory.html",controller:"deleteGroupCategoryCtrl",windowClass:"docPreModal",resolve:{item:function(){return item}}});modalInstance.result.then(function(){$scope.getCategoryList()},function(){})},$scope.getGroupMedicalKnowledgeList=function(){$scope.carActiveId="allCarg",$scope.isSearchByAllCategory=!0,$http.post(app.url.knowledge.getGroupMedicalKnowledgeList,{access_token:app.url.access_token,groupId:curGroupId||"1",pageIndex:$scope.pageIndex-1||0,pageSize:$scope.pageSize||10}).success(function(data){1==data.resultCode?($scope.konwledgeList=data.data.pageData,$scope.pageTotal=data.data.total,$scope.searchTypeIndex=1,$scope.whichType=1,$scope.isPersonKnowledge=!1,0==data.data.total):toaster.pop("error",null,data.resultMsg)}).error(function(data){toaster.pop("error",null,"服务器通讯出错")})},$scope.getDoctorMedicalKnowledgeList=function(){$scope.carActiveId="perCargId",$scope.isSearchByAllCategory=!1,$http.post(app.url.knowledge.getDoctorMedicalKnowledgeList,{access_token:app.url.access_token,doctorId:userId,authorType:0,groupId:curGroupId,pageIndex:$scope.pageIndex-1||0,pageSize:$scope.pageSize||10}).success(function(data){1==data.resultCode&&($scope.konwledgeList=data.data.pageData,$scope.isPersonKnowledge=!0,$scope.pageTotal=data.data.total,$scope.whichType=2,0==data.data.total)}).error(function(data){toaster.pop("error",null,"服务器通讯出错")})},$scope.deleteKnowledge=function(item){var modalInstance=$modal.open({templateUrl:"deletedoctorKlgContentHtml.html",controller:"deletedoctorKlgContentCtrl",size:"md",resolve:{data:function(){return item}}});modalInstance.result.then(function(result){result&&$http.post(app.url.knowledge.delKnowledgeById,{access_token:app.url.access_token,id:item.id}).success(function(data){if(1==data.resultCode){if(!data.data.status)return void toaster.pop("war",null,data.data.msg);toaster.pop("success",null,"删除就医知识成功"),$scope.getDoctorMedicalKnowledgeList()}else toaster.pop("error",null,data.resultMsg)}).error(function(data){})})},$scope.findKnowledgeListByKeys=function(){$http.post(app.url.knowledge.findKnowledgeListByKeys,{access_token:app.url.access_token,keywords:$scope.keyword||"",groupId:curGroupId,pageIndex:$scope.pageIndex-1||0,pageSize:$scope.pageSize||10}).success(function(data){1==data.resultCode?($scope.konwledgeList=data.data.pageData,$scope.whichType=3,$scope.pageTotal=data.data.total,0==data.data.total):toaster.pop("error",null,data.resultMsg)}).error(function(data){toaster.pop("error",null,"服务器通讯出错")})},$scope.getKnowledgeListByCategoryId=function(item){if($scope.isSearchByAllCategory=!1,item.id){var thisItem=item.id;$scope.carActiveId=item.id}else{var thisItem=item;$scope.carActiveId=item}$http.post(app.url.knowledge.getKnowledgeListByCategoryId,{access_token:app.url.access_token,categoryId:thisItem,pageIndex:$scope.pageIndex-1||0,pageSize:$scope.pageSize||10}).success(function(data){1==data.resultCode?($scope.konwledgeList=data.data.pageData,$scope.isPersonKnowledge=!1,$scope.whichType=4,$scope.pageTotal=data.data.total,$scope.actItem=item,0==data.data.total):toaster.pop("error",null,data.resultMsg)}).error(function(data){toaster.pop("error",null,"服务器通讯出错")})},function(){"false"===$stateParams.showGroupKnowledge?$scope.getDoctorMedicalKnowledgeList():$scope.isSearchByAllCategory?$scope.getGroupMedicalKnowledgeList():$scope.isPersonKnowledgeEdit?$scope.getDoctorMedicalKnowledgeList():$scope.isEditBeforeWidthcategoryId?$scope.getKnowledgeListByCategoryId($scope.isEditBeforeWidthcategoryId):$scope.getGroupMedicalKnowledgeList()}(),$scope.setTop=function(item){$http.post(app.url.knowledge.setTop,{access_token:app.url.access_token,id:item.id||"",bizId:userId}).success(function(data){1==data.resultCode?(toaster.pop("success",null,"置顶成功"),$scope.getDoctorMedicalKnowledgeList()):toaster.pop("error",null,data.resultMsg)}).error(function(data){toaster.pop("error",null,"服务器通讯出错")})},$scope.cancelTop=function(item){$http.post(app.url.knowledge.cancelTop,{access_token:app.url.access_token,id:item.id||"",bizId:userId}).success(function(data){1==data.resultCode?(toaster.pop("success",null,"取消置顶成功"),$scope.getDoctorMedicalKnowledgeList()):toaster.pop("error",null,data.resultMsg)}).error(function(data){toaster.pop("error",null,"服务器通讯出错")})},$scope.upKnowledge=function(item){$http.post(app.url.knowledge.upKnowledge,{access_token:app.url.access_token,id:item.id||"",bizId:userId}).success(function(data){1==data.resultCode?(toaster.pop("success",null,"上移成功"),$scope.getDoctorMedicalKnowledgeList()):toaster.pop("error",null,data.resultMsg)}).error(function(data){toaster.pop("error",null,"服务器通讯出错")})},$scope.pageChange=function(){1==$scope.whichType?$scope.getGroupMedicalKnowledgeList():2==$scope.whichType?$scope.getDoctorMedicalKnowledgeList():3==$scope.whichType?$scope.findKnowledgeListByKeys():4==$scope.whichType&&(console.log($scope.actItem.id),$scope.getKnowledgeListByCategoryId($scope.actItem))},$scope.toEditDoctorKnowledge=function(item){$scope.isPersonKnowledge?$state.go("app.doctorKnowledge.edit",{id:item.id,categoryId:item.categoryId,isPersonKnowledge:!0,isTop:item.isTop,isSearchByAllCategory:$scope.isSearchByAllCategory}):$state.go("app_doctorKnowledge_info",{id:item.id,categoryId:item.categoryId,isPersonKnowledge:!1,isTop:item.isTop,isSearchByAllCategory:$scope.isSearchByAllCategory})}}angular.module("app").controller("doctorKnowledgeListCtrl",funGroupKnowledgeListCtrl),funGroupKnowledgeListCtrl.$inject=["$scope","$http","$state","$modal","toaster","$stateParams","$rootScope","$timeout"]}(),app.controller("deleteGroupCategoryCtrl",function($scope,$modalInstance,toaster,$http,item){$scope.item=item,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope["delete"]=function(){localStorage.getItem("curGroupId");$http.post(app.url.knowledge.delCategoryById,{access_token:app.url.access_token,id:item.id}).success(function(data){1==data.resultCode?(toaster.pop("success",null,"分类删除成功"),$modalInstance.close("cancel")):toaster.pop("error",null,data.resultMsg)}).error(function(data){toaster.pop("error",null,data.resultMsg)})}}),app.controller("addGroupCategoryCtrl",function($scope,$modalInstance,toaster,$http,item){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.item=item,$scope.category=item.name;var editType={},message="";$scope.add=function(){var curGroupId=localStorage.getItem("curGroupId");return $scope.category?void(item?(editType=app.url.knowledge.updateCategoryById,message="分类更新成功",$http.post(editType,{access_token:app.url.access_token,groupId:curGroupId,name:$scope.category,id:item.id||""}).success(function(data){1==data.resultCode?(toaster.pop("success",null,message),$modalInstance.close("cancel")):toaster.pop("error",null,data.resultMsg)}).error(function(data){toaster.pop("error",null,data.resultMsg)})):(editType=app.url.knowledge.addGroupCategory,message="分类添加成功",$http.post(editType,{access_token:app.url.access_token,groupId:curGroupId,name:$scope.category}).success(function(data){1==data.resultCode?(toaster.pop("success",null,message),$modalInstance.close("cancel")):toaster.pop("error",null,data.resultMsg)}).error(function(data){toaster.pop("error",null,data.resultMsg)}))):void toaster.pop("info",null,"请先输入分类名！")}}),angular.module("app").controller("deletedoctorKlgContentCtrl",deletedoctorKlgContentCtrl),deletedoctorKlgContentCtrl.$inject=["$scope","$modalInstance","data"];